colnames(pathways_A549vsCOV2_zscore_inputCarnival) <- "Activity"
pathways_A549vsCOV2_zscore_df <- as.data.frame(pathways_A549vsCOV2_zscore) %>%
rownames_to_column(var = "Pathway") %>%
dplyr::arrange(NES) %>%
dplyr::mutate(Pathway = factor(Pathway))
ggplot(pathways_A549vsCOV2_zscore_df,aes(x = reorder(Pathway, NES), y = NES)) +
geom_bar(aes(fill = NES), stat = "identity") +
scale_fill_gradient2(low = "darkblue", high = "indianred",
mid = "whitesmoke", midpoint = 0) +
theme_minimal() +
theme(axis.title = element_text(face = "bold", size = 12),
axis.text.x =
element_text(angle = 45, hjust = 1, size =10, face= "bold"),
axis.text.y = element_text(size =10, face= "bold"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
xlab("Pathways")
## We load Dorothea Regulons
data(dorothea_hs, package = "dorothea")
regulons <- dorothea_hs %>%
dplyr::filter(confidence %in% c("A", "B","C"))
dds_NHBEvsCOV2_stat <-  as.data.frame(dds_NHBEvsCOV2) %>%
rownames_to_column(var = "GeneID") %>%
dplyr::select(GeneID, stat) %>%
dplyr::filter(!is.na(stat)) %>%
column_to_rownames(var = "GeneID") %>%
as.matrix()
tf_activities_NHBEvsCOV2_stat <-
dorothea::run_viper(as.matrix(dds_NHBEvsCOV2_stat), regulons,
options =  list(minsize = 5, eset.filter = FALSE,
cores = 1, verbose = FALSE, nes = TRUE))
tf_activities_NHBEvsCOV2_top25 <- tf_activities_NHBEvsCOV2_stat %>%
as.data.frame() %>%
rownames_to_column(var = "GeneID") %>%
dplyr::rename(NES = "stat") %>%
dplyr::top_n(25, wt = abs(NES)) %>%
dplyr::arrange(NES) %>%
dplyr::mutate(GeneID = factor(GeneID))
tf_activities_NHBEvsCOV2_top25
?viper
tf_activities_NHBEvsCOV2_stat <-
dorothea::run_viper(as.matrix(dds_NHBEvsCOV2_stat), regulons,
options =  list(minsize = 5, eset.filter = FALSE,
cores = 1, verbose = FALSE, nes = TRUE, pleiotropy = TRUE))
tf_activities_NHBEvsCOV2_top25 <- tf_activities_NHBEvsCOV2_stat %>%
as.data.frame() %>%
rownames_to_column(var = "GeneID") %>%
dplyr::rename(NES = "stat") %>%
dplyr::top_n(25, wt = abs(NES)) %>%
dplyr::arrange(NES) %>%
dplyr::mutate(GeneID = factor(GeneID))
tf_activities_NHBEvsCOV2_top25
datasets = list(
racle=racle,
hoek=hoek,
schelker_ovarian=schelker_ovarian
)
load(dataset_racle)
dataset_racle
immunedeconv::dataset_racle
dataset_racle$expr_mat
immunedeconv::dataset_racle$expr_mat
alberto <- immunedeconv::dataset_racle$expr_mat
dim(alberto)
realData <- immunedeconv::dataset_racle$ref
realData
realFractions <- immunedeconv::dataset_racle$ref
sum(realFractions$true_fraction)
realFractions %>% dplyr::filter(sample == "LAU125")
lo <- LinseedObject$new(eset, samples=1:4, topGenes=10000)
eset <- immunedeconv::dataset_racle$expr_mat
lo <- LinseedObject$new(eset, samples=1:4, topGenes=10000)
lo$calculatePairwiseLinearity()
lo$calculateSpearmanCorrelation()
lo$calculateSignificanceLevel(100)
lo$significancePlot(0.01)
lo$filterDatasetByPval(0.01)
lo$svdPlot()
lo$setCellTypeNumber(4)
lo$project("full")
lo$projectionPlot(color="filtered")
lo$project("filtered")
lo$smartSearchCorners(dataset="filtered", error="norm")
lo$deconvolveByEndpoints()
plotProportions(lo$proportions)
realFractions$sample
tidyproportions = lo$proportions %>% as.data.frame %>% rownames_to_column("celltype") %>%
gather(key= "Sample", value = "cell_proportion", -celltype)
tidyproportions
head(realFractions)
0.181 + 0.325 + 0.467 + 0.0579
realFractions %>% dplyr::filter(cell_type = "B cell")
realFractions %>% dplyr::filter(cell_type == "B cell")
realFractions %>% dplyr::filter(cell_type == "B cell") %>% pull(true_fraction) %>% sum()
realFractions %>% dplyr::filter(sample == "LAU125") %>% pull(true_fraction) %>% sum()
tidyproportions = lo$proportions %>% as.data.frame %>% rownames_to_column("celltype") %>%
gather(key= "sample", value = "cell_proportion", -celltype) %>%
left_join(realFractions)
tidyproportions
realFractions
realFractions <- immunedeconv::dataset_racle$ref %>%
dplyr::select(sample, true_fraction)
tidyproportions = lo$proportions %>% as.data.frame %>% rownames_to_column("celltype") %>%
gather(key= "sample", value = "cell_proportion", -celltype) %>%
left_join(realFractions)
tidyproportions
lo$proportions
dim(lo$proportions)
tidyproportions = lo$proportions %>% as.data.frame %>% rownames_to_column("celltype") %>%
gather(key= "sample", value = "cell_proportion", -celltype)
tidyproportions
dim(realFractions)
sum(tidyproportions$cell_proportion)
head(eset)
realFractions <- immunedeconv::dataset_racle$ref
realFractions
expr = matrix(c(
rep(c(1,0,0), 300),
rep(c(0,1,0), 300),
rep(c(0,0,1), 300)), nrow=3)
expr
dim(expr)
gene_names = c("CD8A", "CD4", "CD19")
rownames(expr) = gene_names
cell_types = c(rep("T cell CD8+", 300), rep("T cell CD4+", 300), rep("B cell", 300))
pdata = data.frame(cell_type=cell_types)
fdata = data.frame(gene_symbol=gene_names)
rownames(fdata) = gene_names
eset = ExpressionSet(expr, phenoData=as(pdata, "AnnotatedDataFrame"),
featureData=as(fdata, "AnnotatedDataFrame"))
eset
pdata
head(pdata)
tail(pdata)
fdata = data.frame(gene_symbol=gene_names)
fdata
desired_cell_fractions = tibble("T cell CD8+"=c(0.1, 0.2, 0.3),
"T cell CD4+"=c(0.9, 0.7, 0.5),
"B cell"=c(0, 0.1, 0.2))
new_eset = make_bulk_eset(eset, desired_cell_fractions, n_cells=500)
exprs(new_eset)
library(immunedeconv)
desired_cell_fractions = tibble("T cell CD8+"=c(0.1, 0.2, 0.3),
"T cell CD4+"=c(0.9, 0.7, 0.5),
"B cell"=c(0, 0.1, 0.2))
desired_cell_fractions
new_eset = make_bulk_eset(eset, desired_cell_fractions, n_cells=500)
exprs(new_eset)
immunedeconv::deconvolute(gene_expression_matrix, "quantiseq")
gene_expression_matrix
?deconvolute
lo <- LinseedObject$new("GSE129240", samples=1:14, topGenes=10000)
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
return(results)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
score_G1_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1/S")
score_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G2")
score_M_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M")
score_M_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M/G1")
score_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S")
score_S_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S/G2")
score_S_G2_CALU3vsCOV2
class(score_S_G2_CALU3vsCOV2)
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(Score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples")
return(results)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
score_G1_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1/S")
score_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G2")
score_M_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M")
score_M_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M/G1")
score_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S")
score_S_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S/G2")
score_S_G2_CALU3vsCOV2
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(Score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples")
return(results_df)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
score_G1_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1/S")
score_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G2")
score_M_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M")
score_M_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M/G1")
score_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S")
score_S_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S/G2")
score_S_G2_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2)
AllScores_CALU3vsCOV2
?add_column
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(Score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples") %>%
tibble::add_column(Phase = rep(Cellphase, nrow(results_df)))
return(results_df)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
score_G1_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1/S")
score_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G2")
score_M_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M")
score_M_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M/G1")
score_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S")
score_S_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S/G2")
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples") %>%
tibble::add_column(Phase = rep(Cellphase, nrow(results_df)))
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(Score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples") %>%
tibble::add_column(Phase = rep(Cellphase, nrow(results_df)))
return(results_df)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
setwd("/home/alvaldeolivas/Documents/GitHub/Saezlab/Covid19/")
library(readxl)
library(dplyr)
library(tidyr)
computeSignature <- function(Signature_df, Counts_df, Cellphase){
GeneSignature <- Signature_df %>%
dplyr::select(`ASSIGNED PHASE`, `GENE SYMBOL`) %>%
dplyr::filter(`ASSIGNED PHASE`== Cellphase) %>%
dplyr::distinct() %>%
dplyr::select("GENE SYMBOL") %>%
dplyr::mutate(Score = 1)
Stat_df <- as.data.frame(Counts_df) %>%
tibble::rownames_to_column(var = "GeneID") %>%
dplyr::filter(GeneID %in% GeneSignature$`GENE SYMBOL`)
GeneSignature_final <- GeneSignature %>%
dplyr::filter(`GENE SYMBOL` %in% Stat_df$GeneID) %>%
dplyr::arrange(`GENE SYMBOL`) %>%
tibble::column_to_rownames(var = "GENE SYMBOL") %>%
as.matrix()
Stat_df_final <- Stat_df %>%
dplyr::arrange(GeneID) %>%
tibble::column_to_rownames(var = "GeneID") %>%
as.matrix()
results <-
(t(Stat_df_final) %*% GeneSignature_final)/nrow(GeneSignature_final)
results_df <- results %>%
as.data.frame() %>%
tibble::rownames_to_column(var = "Samples") %>%
tibble::add_column(Phase = rep(Cellphase, nrow(results)))
return(results_df)
}
NormCounts_CALU3vsCOV2 <- readRDS("IntermediateFiles/counts_norm_CALU3vsCOV2.rds")
GeneSignature_df <- read_excel("RawData/1471-2164-10-137-S1.xls")
cellcyclephases <- c("G1", "G1/S", "G2", "M", "M/G1", "S", "S/G2")
score_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1")
score_G1_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G1/S")
score_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "G2")
score_M_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M")
score_M_G1_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "M/G1")
score_S_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S")
score_S_G2_CALU3vsCOV2 <-
computeSignature(GeneSignature_df, NormCounts_CALU3vsCOV2, "S/G2")
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2)
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2
?sub
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples)) %>%
dplyr::mutate(Samples = sub("_.*", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples)) %>%
dplyr::mutate(Samples = sub("_.[0-9]", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples)) %>%
dplyr::mutate(Samples = sub("_.*[0-9]", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2 <- bind_rows(score_G1_CALU3vsCOV2,
score_G1_S_CALU3vsCOV2, score_G2_CALU3vsCOV2, score_M_CALU3vsCOV2,
score_M_G1_CALU3vsCOV2, score_S_CALU3vsCOV2, score_S_G2_CALU3vsCOV2) %>%
dplyr::mutate(Samples = sub("Series7_", "", Samples)) %>%
dplyr::mutate(Samples = sub("_[0-9]", "", Samples))
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2
AllScores_CALU3vsCOV2
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot()
library(ggplot2)
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot()
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_classic()
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_minimal()
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_void()
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_bw()
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_bw() +
facet_wrap(~Phase, scale="free")
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_bw() # +
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_bw()  +
facet_wrap(~Phase)
ggplot(AllScores_CALU3vsCOV2, aes(x=Phase, y=Score, fill=Samples)) +
geom_boxplot() +
theme_bw()  +
facet_wrap(~Phase, scale = "free")
